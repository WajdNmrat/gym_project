<!-- src/app/pages/trainee-dashboard/trainee-dashboard.component.html -->
<div class="trainee-dashboard">

  <!-- Hero / Gradient Header -->
  <div class="dashboard-hero">
    <div class="hero-inner">
      <h2 class="hero-title">ููุญุฉ ุงููุชุฏุฑูุจ</h2>
      <p class="hero-sub">ูุธุฑุฉ ุนุงูุฉ ุนูู ุฎุทุทู ููุดุงุทู ุงูุฃุณุจูุนู</p>
    </div>
  </div>

  <div class="container-fluid dashboard-content">

    <!-- KPIs -->
    <div class="row">
      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card stat-card glass h-100">
          <div class="card-body">
            <div class="stat-label">ูู ุงูุฎุทุท</div>
            <div class="stat-value">{{ kpis.totalPlans }}</div>
          </div>
        </div>
      </div>

      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card stat-card glass h-100">
          <div class="card-body">
            <div class="stat-label">ุฎุทุท ูุนูุงูุฉ</div>
            <div class="stat-value text-success">{{ kpis.activePlans }}</div>
          </div>
        </div>
      </div>

      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card stat-card glass h-100">
          <div class="card-body">
            <div class="stat-label">ูุชูุณุท ุฃูุงู/ุฃุณุจูุน</div>
            <div class="stat-value">{{ kpis.avgDaysPerWeek }}</div>
          </div>
        </div>
      </div>

      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card stat-card glass h-100">
          <div class="card-body">
            <div class="stat-label">ูุชูุณุท ุงููุฏุฉ (ุฏ)</div>
            <div class="stat-value">{{ kpis.avgDuration }}</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Charts -->
    <div class="row">
      <div class="col-lg-5 mb-3">
        <div class="card chart-card glass h-100">
          <div class="card-header pb-2">
            <h5 class="mb-0">ุญุงูุฉ ุงูุฎุทุท</h5>
            <small class="text-muted">Active vs Inactive</small>
          </div>
          <div class="card-body chart-body">
            <canvas #doughnutRef></canvas>
          </div>
        </div>
      </div>

      <div class="col-lg-7 mb-3">
        <div class="card chart-card glass h-100">
          <div class="card-header pb-2">
            <h5 class="mb-0">ุชูุฒูุน ุงูุฎุทุท ุญุณุจ ุฃูุงู/ุฃุณุจูุน</h5>
            <small class="text-muted">ูุธุฑุฉ ุณุฑูุนุฉ ุนูู ุฅุนุฏุงุฏุงุชู ุงูุฃุณุจูุนูุฉ</small>
          </div>
          <div class="card-body chart-body">
            <canvas #barRef></canvas>
          </div>
        </div>
      </div>
    </div>

    <!-- ุฎุทุฉ ุงูููู -->
    <div class="row">
      <div class="col-12 mb-3">
        <div class="card glass border-success">
          <div class="card-header pb-2 d-flex align-items-center justify-content-between">
            <div>
              <h5 class="mb-0 text-success">ุฎุทุฉ ุงูููู ({{ todayLabel }})</h5>
              <small class="text-muted">ุงูุฎุทุท ุงูุฎุงุตุฉ ุจูุฐุง ุงูููู ููุท</small>
            </div>

            <!-- ุงุณู ุงููุฏุฑูุจ -->
            <small class="text-muted">
              ุงููุฏุฑูุจ:
              <ng-container *ngIf="trainerId; else noTrainer">
                <a
                  [routerLink]="['/user-profile']"
                  [queryParams]="{ id: trainerId }"
                  target="_blank"
                  rel="noopener"
                  class="fw-600"
                  title="ูุชุญ ุจุฑููุงูู ุงููุฏุฑูุจ ูู ุชุจููุจ ุฌุฏูุฏ">
                  {{ trainerName || '-' }}
                </a>
              </ng-container>
              <ng-template #noTrainer>
                <span class="fw-600">{{ trainerName || '-' }}</span>
              </ng-template>
            </small>
          </div>

          <div class="card-body p-0">
            <div class="table-responsive">
              <table class="table table-hover mb-0 nice-table">
                <thead class="table-success">
                  <tr>
                    <th>ุงูุนููุงู</th>
                    <th>ุงููุตู</th>
                    <th>ุฃูุงู/ุฃุณุจูุน</th>
                    <th>Sets</th>
                    <th>Reps</th>
                    <th>ุงููุฏุฉ (ุฏ)</th>
                    <th>ุงูุฃุฌูุฒุฉ</th> <!-- ๐ ุงูุนููุฏ ุงูุฌุฏูุฏ -->
                    <th>ุงููุฏุฑูุจ</th>
                    <th>ุงูุญุงูุฉ</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let p of todayPlans">
                    <td class="fw-600">{{ p.title || '-' }}</td>
                    <td class="text-truncate" style="max-width: 360px;">
                      {{ p.description || '-' }}
                    </td>
                    <td>{{ p.days_per_week }}</td>
                    <td>{{ p.sets }}</td>
                    <td>{{ p.reps }}</td>
                    <td>{{ p.duration_minutes }}</td>

                    <!-- ุฃุณูุงุก ุงูุฃุฌูุฒุฉ -->
                    <td class="text-truncate" style="max-width: 320px;">
                      {{ p['machines_names'] || '-' }}
                    </td>

                    <!-- ุงููุฏุฑูุจ -->
                    <td>
                      <ng-container *ngIf="trainerId; else plainTrainer">
                        <a
                          [routerLink]="['/user-profile']"
                          [queryParams]="{ id: trainerId }"
                          target="_blank"
                          rel="noopener"
                          class="fw-600"
                          title="ูุชุญ ุจุฑููุงูู ุงููุฏุฑูุจ ูู ุชุจููุจ ุฌุฏูุฏ">
                          {{ trainerName || '-' }}
                        </a>
                      </ng-container>
                      <ng-template #plainTrainer>
                        <span class="fw-600">{{ trainerName || '-' }}</span>
                      </ng-template>
                    </td>

                    <td>
                      <span class="badge" [ngClass]="p.is_active ? 'badge-success' : 'badge-secondary'">
                        {{ p.is_active ? 'ูุนูุงูุฉ' : 'ูุชูููุฉ' }}
                      </span>
                    </td>
                  </tr>

                  <tr *ngIf="todayPlans.length === 0">
                    <td colspan="9" class="text-center text-muted py-3">ูุง ุชูุฌุฏ ุฎุทุฉ ููุฐุง ุงูููู</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

        </div>
      </div>
    </div>

  </div>
</div>
